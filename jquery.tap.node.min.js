module.exports=function(e){function t(t,a,n,o){var i=n.type;n.type=a,e.event.dispatch.call(t,n,o),n.type=i}e.attrFn=e.attrFn||{};var a=navigator.userAgent.toLowerCase(),n=a.indexOf("chrome")>-1&&(a.indexOf("windows")>-1||a.indexOf("macintosh")>-1||a.indexOf("linux")>-1)&&a.indexOf("mobile")<0&&a.indexOf("android")<0,o={taphold_threshold:750,touch_capable:"ontouchstart"in window&&!n,startevent:"ontouchstart"in window&&!n?"touchstart":"mousedown",endevent:"ontouchstart"in window&&!n?"touchend":"mouseup"};e.fn.tap=function(e){return e?this.on("tap",e):this.trigger("tap")},e.event.special.tap={setup:function(){var a,n,i=this,r=e(i),c=!1,h=null,g={x:0,y:0};r.on(o.startevent,function s(e){return r.data("callee1",s),e.which&&1!==e.which?!1:(c=!0,g.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,g.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY,a=Date.now(),h=e.target,n=e.originalEvent.targetTouches?e.originalEvent.targetTouches:[e],!0)}).on(o.endevent,function u(e){r.data("callee2",u);var s=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,p=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageY:e.pageY,l=g.x-s,d=g.y-p;if(h==e.target&&c&&Date.now()-a<o.taphold_threshold&&(g.x==s&&g.y==p||l>=-o.tap_pixel_range&&l<=o.tap_pixel_range&&d>=-o.tap_pixel_range&&d<=o.tap_pixel_range)){for(var f=e.originalEvent,v=[],x=0;x<n.length;x++){var w={position:{x:o.touch_capable?f.changedTouches[x].screenX:e.screenX,y:o.touch_capable?f.changedTouches[x].screenY:e.screenY},offset:{x:o.touch_capable?Math.round(f.changedTouches[x].pageX-r.offset().left):Math.round(e.pageX-r.offset().left),y:o.touch_capable?Math.round(f.changedTouches[x].pageY-r.offset().top):Math.round(e.pageY-r.offset().top)},time:Date.now(),target:e.target};v.push(w)}t(i,"tap",e,v)}})},remove:function(){e(this).off(o.startevent,e(this).data.callee1).off(o.endevent,e(this).data.callee2)}}};
